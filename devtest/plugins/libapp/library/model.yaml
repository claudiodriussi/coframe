tables:

  User:
    columns:
      - name: employee_id
        type: ShortStr
        unique: true
        nullable: true

      - name: department
        type: String
        length: 50
        nullable: true

      - name: phone
        type: String
        length: 20
        nullable: true

  Book:
    columns:
      - name: status
        type: String
        length: 1
        default: "'A'"

      - name: isbn
        type: SKU
        length: 50
        unique: false

  LibraryUser:
    name: library_users
    mixins: [TimeStamp, Credentials]
    columns:
      - name: id
        type: ID

      - name: name
        type: Name
        index: False

      - name: address
        type: Address
        prefix: a_

      - name: is_student
        label: "Student"
        type: Boolean
        default: False

      - name: membership_number
        type: String
        length: 50
        unique: true
        nullable: true

      - name: membership_date
        type: Date
        nullable: true

      - name: membership_expires
        type: Date
        nullable: true

      - name: phone
        type: Phone
        help: "Contact phone number"

      - name: notes
        type: Text
        nullable: true


  Review:
    name: reviews
    tags: [journal]
    mixins: [TimeStamp]
    columns:
      - name: id
        type: ID

      - name: rating
        type: Integer

      - name: comment
        type: Text

      - name: library_user_id
        foreign_key:
          target: LibraryUser.id

      - name: book_id
        foreign_key:
          target: Book.id

  Loan:
    name: loans
    tags: [journal]
    mixins: [TimeStamp]
    columns:
      - name: id
        type: ID

      - name: borrowed_at
        type: DateTime
        default: datetime.now
        nullable: false

      - name: due_date
        type: DateTime
        nullable: false

      - name: returned_at
        type: DateTime
        nullable: true

      - name: library_user_id
        foreign_key:
          target: LibraryUser.id

      - name: book_id
        foreign_key:
          target: Book.id
